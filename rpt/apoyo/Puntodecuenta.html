<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Formulario</title>
    <style>
        table {
            font-family: arial, sans-serif;
            font-size: 12px;
            border-collapse: collapse;
            width: 800px;
        }

        td {

            text-align: left;
            padding: 8px;
        }

        th {
            border: 1px solid #dddddd;
            text-align: left;
            background-color: #dddddd;
            padding: 8px;
        }

        /*tr:nth-child(even) {
            background-color: #dddddd;
        }*/
    </style>
</head>
<BODY>
<center>
    <table style="width: 1000px">
        <tr>
            <td style="width: 5%"><img src="../../images/lg1.png" style="width: 100%; margin-top: 44%"><br>
                <p style="color:transparent">agdagsgsgsaaaaaaa</p></td>

            <td style="width: 30%;  border: 0px solid #dddddd;font-size: 10px;">

                <p style="width: 100%; text-align: center">REPÚBLICA BOLIVARIANA DE VENEZUELA<BR>
                    MINISTERIO DEL PODER POPULAR PARA LA DEFENSA<BR>
                    VICEMINISTERIO DE SERVICIOS, PERSONAL Y LOGISTICA<BR>
                    DIRECCIÓN GENERAL DE EMPRESAS<BR>
                    INSTITUTO DE PREVISIÓN SOCIAL<BR>
                    DE LAS FUERZAS ARMADAS<BR></p>
            </td>
            <td style="width: 35%;  border: 0px solid #dddddd; text-align: center;">
                <h3 style="font-size: 200%">PRESENTACIÓN DE CUENTA A LA PRESIDENCIA</h3>

            </td>
        </tr>
    </table>

    <table style="width: 1000px;  text-align: justify;  font-size: 14px">

        <tr>
            <td>DE:</td>
            <td><b>GERENCIA DE BIENESTAR Y SEGURIDAD SOCIAL</b></td>
            <td>
                <center><b>
                    Nro. <b id="lblnsolicitud"></b> Fecha: <b id="lblfecha"></b>
                </b></center>
            </td>
        </tr>
        <tr>
            <!--<td>DE:</td>-->
            <!--<td><b>GERENCIA DE BIENESTAR Y SEGURIDAD SOCIAL</b></td>-->

            <center>
                <button onclick="imprimir()" id="btnPrint">Imprimir Reporte</button>
            </center>

        </tr>

    </table>

    <table style="width: 1000px;" border="1">
        <tr>
            <td style="width: 550px;">ASUNTO</td>
            <td>RECOMENDACIÓN</td>
            <td>DESICIÓN</td>
        </tr>
        <tr>
            <td style="text-align: justify; font-size: 14px; line-height: 1.5" valign="top">
                &emsp;Esta Gerencia somete a la consideración del ciudadano <b>GRAL. DE BRIGADA PRESIDENTE del IPSFA</b>,
                lo siguiente:<br><br>

                &emsp;La (el) Ciudadana (o): <b id="lblnombe"></b> C.I.N°:<b id="lblci"></b> de <b id="edad"></b><b
                    id="edadafi"></b> años de edad, quien
                presenta
                diagnostico médico de: <b id="lblpatologia"></b>, por lo que amerita: <a style="text-decoration: none;color: #000000" href="#" onclick="convertirtextarea()"><b id="informe1"></b></a>
                <textarea id="inform" style="width: 100%" onblur="informe()" rows="3"></textarea>el afiliado es <b
                    id="lblparentesco"></b> del <b id="lblgrado"> </b>
                <b id="lblnombre"></b>
                C.I.N°<b id="lblcedula"></b>, por lo que presenta presupuesto N°:<b id="npresupuesto"></b> de fecha <b id="fechapresupueso"></b>
                elaborado por <b id="nombreempresa"></b> por un monto de <b id="montosolicitado"></b><b> Bs</b>.<br><br>

                El presente punto de cuenta se realiza en virtud que Seguros Horizontes emite constancia de fecha <b id="fechacreacion"></b>
                indicando indemnizar la cantidad de <b id="montoadar"></b> <b>Bs</b>. agotando cobertura por patología para el
                presente año, quedando al afiliado una diferencia a cancelar de <b id="monto2"></b> <b>Bs</b>. Manisdestando el
                profesional no contar con el recurso
                fianciero para cancelar el material médico que le permita mejorar la calidad de vida de su <b id="lblparentesco1"></b>.
                <br><br>
                <br><br><br>

                Emitir CARTA AVAL a nombre de: <b id="nombreempresa1"></b> <b>RIF.</b><b id="rifempresa"></b>.


            </td>
            <td style="width: 325px;text-align: justify; font-size: 14px; line-height: 1.5" valign="top">

                <table style="height: 100%; width: 100%">
                    <tr style="height: 50%; width: 100%">
                        Esta gerencia respetuosamente se permite recomendar lo siguiente:
                        <br><br>
                        <center>
                            ___________________________________
                            ___________________________________
                            ___________________________________
                            ___________________________________
                            ___________________________________
                            ___________________________________
                            ___________________________________
                            ___________________________________
                        </center>
</center>

<br><br>
<ul>
    <li>Otra criterio de la presidencia.</li>
</ul>
</tr>


<tr style="height: 50%; width: 100%; text-align: justify; font-size: 14px; line-height: 1.5"
    valign="bottom">
    <td colspan="4">
        <br><br><br><br><br><br>
        <br><br><br><br><br><br>
        <b>
            <center>
                MARTINEZ SALAS EDUARDO JOSE<BR>
                CORONEL<BR>
                GERENTE DE BIENESTAR Y SEGURIDAD SOCIAL<BR>
            </center>
        </B>
    </td>
</tr>
</table>


</td>

<td style="width: 225px;text-align: justify; font-size: 14px; line-height: 1.5" valign="top">
    <table style="height: 100%; width: 100%">
        <tr style="height: 50%; width: 100%">

            <br><br><br>
            <center>
                ___________________________________
                ___________________________________
                ___________________________________
                ___________________________________
                ___________________________________
                ___________________________________
                ___________________________________
                ___________________________________
            </center>

            <br><br><br><br><br>
        </tr>


        <tr style="height: 50%; width: 100%; text-align: justify; font-size: 14px; line-height: 1.5"
            valign="bottom">
            <td colspan="4">
                <br><br><br><br><br><br>
                <br><br><br><br><br>
                <b>
                    <center>
                        SALAZAR VELASQUEZ JESUS RAFAEL<BR>
                        GENERAL DE BRIGADA.<BR>
                        PRESIDENTE DE LA JUNTA ADMINISTRADOR I.P.S.F.A.<BR>
                    </center>
                </B>
            </td>
        </tr>
    </table>
</td>
<tr style="height: 50%; width: 100%">

</tr>


</td>
</tr>
</table>
</center>
<br>
</body>
<script src="../../bower_components/jquery/dist/jquery.min.js"></script>
<script src="../../bower_components/formato/numeral.js"></script>

<script src="../../js/utilidad.js"></script>
<script src="../../js/militar.js"></script>
<script src="../../js/config.js"></script>
<script src="../../js/controlador.js"></script>
<script>
    function informe() {
        var text = document.getElementById("inform").value;
        var words = text.split("\n");
        if (words != "") {
            document.getElementById('inform').style.display = 'none';
            document.getElementById('informe1').style.display ='block';
            document.getElementById('informe1').innerHTML = words;
        }
    }
    function convertirtextarea() {
        document.getElementById('inform').style.display = 'block';
        document.getElementById('informe1').style.display ='none';
    }
    let pos = '';
    $(function () {
        numeral.locale('es-es');
        $.obtener = function (key) {
            key = key.replace(/[\[]/, '\\[');
            key = key.replace(/[\]]/, '\\]');
            var pattern = "[\\?&]" + key + "=([^&#]*)";
            var regex = new RegExp(pattern);
            var url = unescape(window.location.href);
            var results = regex.exec(url);
            if (results === null) {
                return null;
            } else {
                return results[1];
            }
        };
        var id = $.obtener("id");
        pos = $.obtener("pos");
        console.log(id);
        Buscar(id);
    });

    function Buscar(id) {
        console.log(militar);
        if (id != undefined) {
            $("#_cedula").val(id);
        }
        if ($("#_cedula").val() == "") {
            return false;
        }

        var url = Conn.URL + "militar/crud/" + id;
        var request = CargarAPI({
            sURL: url,
            metodo: 'GET',
            valores: '',
            Objeto: militar
        });

        request.then(function (xhRequest) {
            militar = JSON.parse(xhRequest.responseText);
            llenar(id);
            console.log(militar);
        });


        //CargarAPI(url, "GET", "", militar);


    }



    function llenar(formato) {
        if (formato != undefined) {

        }

        if (militar.Persona != undefined) {
            var ncompleto = militar.Persona.DatoBasico.nombreprimero + " " + militar.Persona.DatoBasico.apellidoprimero;
            $("#lblnombre").text(ncompleto);

            $("#lblcomponente").text(militar.Componente.descripcion);

            $("#lblgrado").text(militar.Grado.descripcion);

            $("#lblcedula").text(militar.Persona.DatoBasico.cedula);

            crearLista();
            var estcivil = Util.GenerarEstadoCivil(militar.Persona.DatoBasico.estadocivil, militar.Persona.DatoBasico.sexo);

            $("#lblestadocivil").text(estcivil);

            $("#lblsituacion").text(Util.ConvertirSitucacion(militar.situacion));
            var defestados = JSON.parse(sessionStorage.getItem("ipsfaEstado"));
            if (militar.Persona.Direccion != undefined) {
                var DIR = militar.Persona.Direccion[0];
                Estados.ObtenerEstados();
                var estado = "";
            }
        } else {
            alert("Cedula no se encuentra registrada como militar dentro del sistema");
        }
    }

    function crearLista() {
        if (pos == null) {
            pos = militar.CIS.ServicioMedico.Programa.Apoyo.length;
            pos--;
        }
        var apo = militar.CIS.ServicioMedico.Programa.Apoyo[pos];
        $("#lblnsolicitud").text(apo.numero);
        $("#fechacreacion").text(Util.ConvertirFechaHumana(apo.fechacreacion));
        var tipoc = apo.CuentaBancaria.tipo == "CA" ? "CUENTA DE AHORRO" : "CUENTA CORRIENTE";
        var concep = militar.CIS.ServicioMedico.Programa.Apoyo[pos];
        var fila = "";
        concep.Concepto.forEach(v => {
            var porcen = v.DatoFactura.montoaprobado * 100 / v.DatoFactura.monto;
            var bene = v.afiliado.split("-");
            var paren = bene[1].split("(");
            var tam = paren[1].length;
            $("#lblnombe").text(paren[0]);
            $("#lblci").text(bene[0]);
            $("#lblpatologia").text(v.patologia);
            $("#lblparentesco").text(paren[1].substring(0, (tam - 1)));
            $("#lblparentesco1").text(paren[1].substring(0, (tam - 1)));
            var mntformato = numeral(parseFloat(v.DatoFactura.monto)).format('0,0.00');
            $("#montosolicitado").text(mntformato);
            $("#npresupuesto").text(v.DatoFactura.control);
            $("#fechapresupueso").text(Util.ConvertirFechaHumana(v.DatoFactura.fecha));
            $("#nombreempresa").text(v.DatoFactura.Beneficiario.razonsocial);
            $("#nombreempresa1").text(v.DatoFactura.Beneficiario.razonsocial);
            $("#rifempresa").text(v.DatoFactura.Beneficiario.rif);
            var mntaseguradora = numeral(parseFloat(v.montoaseguradora)).format('0,0.00');
            var mntotrosaportes = numeral(parseFloat(v.montoaportar)).format('0,0.00');
            var mntformato2 = numeral(parseFloat(apo.montosolicitado)).format('0,0.00');
            $("#montoadar").text(mntformato2);
            var monto2 = 0;
            monto2 = (v.DatoFactura.monto)-(apo.montosolicitado);
            $("#monto2").text(numeral(parseFloat(monto2)).format('0,0.00'));

            if(paren[1].substring(0, (tam - 1))=="MILITAR"){
            var edad = Util.CalcularEdad(Util.ConvertirFechaHumana(militar.Persona.DatoBasico.fechanacimiento));
            $("#edad").html(edad);}else{
            militar.Familiar.forEach(v => {
                if (v.Persona.DatoBasico.cedula == bene[0]) {
                    var edadafi = Util.CalcularEdad(Util.ConvertirFechaHumana(v.Persona.DatoBasico.fechanacimiento));
                    $("#edadafi").html(edadafi);
                    console.log(edadafi);
                }


            });}
        });



    }
</script>
<script language="Javascript">
    function imprimir() {
        document.getElementById('btnPrint').style.display = 'none';
        window.print();
        window.close();
    }
</script>
</html>
