<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Formulario</title>
    <style>
        table {
            font-family: arial, sans-serif;
            font-size: 12px;
            border-collapse: collapse;
            width: 800px;
        }

        td {

            text-align: left;
            padding: 8px;
        }

        th {
            border: 1px solid #dddddd;
            text-align: left;
            background-color: #dddddd;
            padding: 8px;
        }

        /*tr:nth-child(even) {
            background-color: #dddddd;
        }*/
    </style>
</head>
<BODY>
<center>
    <table style="width: 1000px">
        <tr>
            <td style="width: 65%;  border: 0px solid #dddddd; text-align: center; font-size: 10px">
                REPÚBLICA BOLIVARIANA DE VENEZUELA<BR>
                MINISTERIO DEL PODER POPULAR PARA LA DEFENSA<BR>
                VICEMINISTERIO DE SERVICIOS, PERSONAL Y LOGISTICA<BR>
                DIRECCIÓN GENERAL DE EMPRESAS<BR>
                INSTITUTO DE PREVISIÓN SOCIAL<BR>
                DE LAS FUERZAS ARMADAS<BR>
            </td>
            <td style="width: 35%;  border: 0px solid #dddddd; text-align: right;">
                Sistema PACE<br>
                <?php echo 'Caracas, ' . $f[2] . ' de ' . fecha($f[1]*1) . ' de '. $f[0] ?>

            </td>
        </tr>
    </table>

    <table style="width: 1000px;  text-align: justify;  font-size: 14px">

        <tr>
            <td>PARA:</td>
            <td><b>PRESIDENTE DEL IPSFA</b></td>
            <td>
                <center><b>
                    Nro. 320.600-<?php echo substr(md5($Beneficiario->cedula .
                    $Beneficiario->fecha_ultima_modificacion), 0,6);?>r
                </b></center>
            </td>
        </tr>
        <tr>
            <td>DE:</td>
            <td><b>GERENCIA DE BIENESTAR Y SEGURIDAD SOCIAL</b></td>
            <td>
                <center>
                    <button onclick="imprimir()" id="btnPrint">Imprimir Reporte</button>
                </center>
            </td>
        </tr>

    </table>

    <table style="width: 1000px;" border="1">
        <tr>
            <td style="width: 550px;">TITULO DEL ASUNTO</td>
            <td>DECISIÓN</td>
            <td>OBSERVACIÓN</td>
        </tr>
        <tr>
            <td style="text-align: justify; font-size: 14px; line-height: 1.5" valign="top">
                &emsp;Esta Gerencia somete a la consideración del ciudadano GD. Presidente de la Junta Administradora
                del IPSFA,
                la solicitud formulada por <b><?php
          echo $Beneficiario->Componente->Grado->nombre . ' ' . $Beneficiario->nombres . ' ' . $Beneficiario->apellidos;
                ?>
            </b> titular de la cédula de identidad <b><?php echo $Beneficiario->cedula . ' (' .
                $Beneficiario->Componente->nombre . ')';?>
            </b> de un adelanto de su
                Asignación de Antiguedad, con la finalidad:<b> <?php echo strtoupper($finalidad);?></b><br><br>

                &emsp;Esta solicitud cumple con lo establecido en el Arículo 59 de la LOSSFANB (LEY NEGRO
                PRIMERO).<br><br>

                &emsp;Al profesional le corresponde por concepto de Asignación de Antiguedad (Años de Servicios
                cumplidos),
                la cantidad de Bs. <b><?php echo $Beneficiario->Calculo['asignacion_antiguedad'];?></b> Actualmente se
                le ha depositado un monto
                total de Bs.<b><?php echo $Beneficiario->Calculo['asignacion_depositada'];?></b> lo que representa el
                <b><?php echo $Beneficiario->Calculo['porcentaje_cancelado'];?>%</b> de la Asignación de Antiguedad y se
                han
                otorgado adelantos que totalizan la cantidad de Bs.
                <b><?php echo number_format($anticipo, 2, ',','.');?>.</b>
                El monto a otorgar es de Bs. <b><?php echo number_format($monto, 2, ',','.');?></b> lo que representa el
                <b><?php echo number_format($porcentaje, 0, ',','.');?>%</b> del total depositado en banco.
                <br><br>
                &emsp;Por lo que me permito realizar esta tramitación con opinión favorable.<br><br>

                <center><b>CNEL. EDUARDO JOSE MARTINEZ SALAS<BR>
                    GERENTE DE BIENESTAR Y SEGURIDAD SOCIAL<B>
                        <center>


            </td>
            <td style="width: 325px;text-align: justify; font-size: 14px; line-height: 1.5" valign="top">

                <table style="height: 100%; width: 100%">
                    <tr style="height: 50%; width: 100%">
                        <td>APROBADO</td>
                        <td><input type="text" style="width:20px"></input></td>
                        <td>NEGADO</td>
                        <td><input type="text" style="width:20px"></input></td>
                    </tr>
                    <tr style="height: 50%; width: 100%">
                        <td>VISTO</td>
                        <td><input type="text" style="width:20px"></input></td>
                        <td>DIFERIDO</td>
                        <td><input type="text" style="width:20px"></input></td>
                    </tr>
                    <tr style="height: 50%; width: 100%">
                        <td>OTRO</td>
                        <td><input type="text" style="width:20px"></input></td>
                        <td></td>
                        <td></td>
                    </tr>


                    <tr style="height: 50%; width: 100%; text-align: justify; font-size: 14px; line-height: 1.5"
                        valign="bottom">
                        <td colspan="4">
                            <br><br><br><br><br><br>
                            <br><br><br><br><br><br>
                            <b>
                                <center>
                                    JESÚS RAFAEL SALAZAR VELASQUEZ<BR>
                                    GENERAL DE DIVISIÓN<BR>
                                    PRESIDENTE DEL I.P.S.F.A<BR>
                                </center>
                            </B>
                        </td>
                    </tr>
                </table>


            </td>

            <td style="width: 225px;text-align: justify; font-size: 14px; line-height: 1.5" valign="top">
                Según Resolución N° DG-00044 del 08FEBB99, se delegó la firma Parcial de la Asignación de Antiguedad del
                personal militar,
                al General de División Presidente de la Junta Administradora del Instituto de Previsión Social de las
                Fuerzas Armadas.
            </td>
        </tr>
    </table>
</center>
<br>
&emsp;&emsp;&emsp;EMG/<?php echo $usuario;?>

<script language="Javascript">
    function imprimir() {
        document.getElementById('btnPrint').style.display = 'none';
        window.print();
        window.close();
    }
</script>
<script src="bower_components/jquery/dist/jquery.min.js"></script>
<script src="bower_components/formato/numeral.js"></script>

<script src="js/utilidad.js"></script>
<script src="js/militar.js"></script>
<script src="js/config.js"></script>
<script src="js/controlador.js"></script>
<script>
    let pos='';
    $(function () {
        numeral.locale('es-es');
        $.obtener = function (key) {
            key = key.replace(/[\[]/, '\\[');
            key = key.replace(/[\]]/, '\\]');
            var pattern = "[\\?&]" + key + "=([^&#]*)";
            var regex = new RegExp(pattern);
            var url = unescape(window.location.href);
            var results = regex.exec(url);
            if (results === null) {
                return null;
            } else {
                return results[1];
            }
        };
        var id = $.obtener("id");
        pos = $.obtener("pos");
        console.log(id);
        Buscar(id);
    });

    function Buscar(id) {
        console.log(militar);
        if (id != undefined) {
            $("#_cedula").val(id);
        }
        if ($("#_cedula").val() == "") {
            return false;
        }

        var url = Conn.URL + "militar/crud/" +id;
        var request = CargarAPI({
            sURL: url,
            metodo: 'GET',
            valores: '',
            Objeto: militar
        });

        request.then(function (xhRequest) {
            militar = JSON.parse(xhRequest.responseText);
            llenar(id);

        });


        //CargarAPI(url, "GET", "", militar);


    }

    function llenar(formato) {
        if (formato != undefined) {

        }
        if (militar.Persona != undefined) {
            var ncompleto = militar.Persona.DatoBasico.nombreprimero + " " + militar.Persona.DatoBasico.apellidoprimero;
            $("#lblnombre").text(ncompleto);

            $("#lblcomponente").text(militar.Componente.descripcion);

            $("#lblgrado").text(militar.Grado.descripcion);

            $("#lblcedula").text(militar.Persona.DatoBasico.cedula);

            crearLista();

            var estcivil = Util.GenerarEstadoCivil(militar.Persona.DatoBasico.estadocivil, militar.Persona.DatoBasico.sexo);

            $("#lblestadocivil").text(estcivil);

            $("#lblsituacion").text(Util.ConvertirSitucacion(militar.situacion));
            var defestados = JSON.parse(sessionStorage.getItem("ipsfaEstado"));
            console.log(defestados);
            if (militar.Persona.Direccion != undefined) {
                var DIR = militar.Persona.Direccion[0];
                Estados.ObtenerEstados();
                var estado = "";

                $.each(defestados,function(){
                    if(this.codigo == DIR.estado){
                        estado = this.nombre;
                    }
                });

                var rirec ="ESTADO "+ estado + ", CIUDAD " + DIR.ciudad + ", MUNICIPIO " + DIR.municipio + ", PARROQUIA " + DIR.parroquia + ", AV/CALLE " + DIR.calleavenida + ", CASA/APT " + DIR.casa + "|" + DIR.apartamento
                $("#lbldireccion").text(rirec);
            }

        } else {
            alert("Cedula no se encuentra registrada como militar dentro del sistema");
        }
    }

    function crearLista() {
        if(pos == null){
            pos=militar.CIS.ServicioMedico.Programa.Reembolso.length;
            pos--;
        }
        console.log(pos);

        var reem = militar.CIS.ServicioMedico.Programa.Reembolso[pos];
        console.log(reem);
        console.log(reem.CuentaBancaria.institucion);
        $("#lblnsolicitud").text(reem.numero);
        $("#lblfecha").text(Util.ConvertirFechaHumana(reem.fechacreacion));
        $("#lblbanco").text(Util.ConvertirBanco(reem.CuentaBancaria.institucion));
        $("#lblcuenta").text(reem.CuentaBancaria.cuenta);

        var tipoc = reem.CuentaBancaria.tipo=="CA" ? "CUENTA DE AHORRO":"CUENTA CORRIENTE";
        $("#lbltipoc").text(tipoc);
        $("#lblmontot").text(numeral(parseFloat(reem.montosolicitado)).format('0,0.00'));
        var concep = militar.CIS.ServicioMedico.Programa.Reembolso[pos];
        var fila ="";
        $.each(concep.Concepto,function () {
            var bene = this.afiliado.split("-");
            var paren = bene[1].split("(");
            var tam = paren[1].length;
            var mntformato = numeral(parseFloat(this.DatoFactura.monto)).format('0,0.00');
            fila+= "<tr><td>"+paren[1].substring(0,(tam-1))+"</td><td>"+bene[0]+"</td><td>"+paren[0]+"</td><td>"+this.descripcion+"</td><td style=\"text-align: right\">"+mntformato+"</td><td></td><td></td></tr>";
        });
        $("#cuerpoConceptos").html(fila);
    }
</script>
</body>
</html>